/**
 * @license almond 0.2.9 Copyright (c) 2011-2014, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/almond for details
 */

/*!
 *
 * Copyright 2009-2012 Kris Kowal under the terms of the MIT
 * license found at http://github.com/kriskowal/q/raw/master/LICENSE
 *
 * With parts by Tyler Close
 * Copyright 2007-2009 Tyler Close under the terms of the MIT X license found
 * at http://www.opensource.org/licenses/mit-license.html
 * Forked at ref_send.js version: 2009-05-11
 *
 * With parts by Mark Miller
 * Copyright (C) 2011 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 */

//     Underscore.js 1.6.0
//     http://underscorejs.org
//     (c) 2009-2014 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
//     Underscore may be freely distributed under the MIT license.

!function(){var t,n,e;!function(r){function i(t,n){return _.call(t,n)}function o(t,n){var e,r,i,o,u,s,c,a,f,l,p,h=n&&n.split("/"),d=g.map,v=d&&d["*"]||{};if(t&&"."===t.charAt(0))if(n){for(h=h.slice(0,h.length-1),t=t.split("/"),u=t.length-1,g.nodeIdCompat&&k.test(t[u])&&(t[u]=t[u].replace(k,"")),t=h.concat(t),f=0;f<t.length;f+=1)if(p=t[f],"."===p)t.splice(f,1),f-=1;else if(".."===p){if(1===f&&(".."===t[2]||".."===t[0]))break;f>0&&(t.splice(f-1,2),f-=2)}t=t.join("/")}else 0===t.indexOf("./")&&(t=t.substring(2));if((h||v)&&d){for(e=t.split("/"),f=e.length;f>0;f-=1){if(r=e.slice(0,f).join("/"),h)for(l=h.length;l>0;l-=1)if(i=d[h.slice(0,l).join("/")],i&&(i=i[r])){o=i,s=f;break}if(o)break;!c&&v&&v[r]&&(c=v[r],a=f)}!o&&c&&(o=c,s=a),o&&(e.splice(0,s,o),t=e.join("/"))}return t}function u(t,n){return function(){return h.apply(r,b.call(arguments,0).concat([t,n]))}}function s(t){return function(n){return o(n,t)}}function c(t){return function(n){y[t]=n}}function a(t){if(i(m,t)){var n=m[t];delete m[t],w[t]=!0,p.apply(r,n)}if(!i(y,t)&&!i(w,t))throw new Error("No "+t);return y[t]}function f(t){var n,e=t?t.indexOf("!"):-1;return e>-1&&(n=t.substring(0,e),t=t.substring(e+1,t.length)),[n,t]}function l(t){return function(){return g&&g.config&&g.config[t]||{}}}var p,h,d,v,y={},m={},g={},w={},_=Object.prototype.hasOwnProperty,b=[].slice,k=/\.js$/;d=function(t,n){var e,r=f(t),i=r[0];return t=r[1],i&&(i=o(i,n),e=a(i)),i?t=e&&e.normalize?e.normalize(t,s(n)):o(t,n):(t=o(t,n),r=f(t),i=r[0],t=r[1],i&&(e=a(i))),{f:i?i+"!"+t:t,n:t,pr:i,p:e}},v={require:function(t){return u(t)},exports:function(t){var n=y[t];return"undefined"!=typeof n?n:y[t]={}},module:function(t){return{id:t,uri:"",exports:y[t],config:l(t)}}},p=function(t,n,e,o){var s,f,l,p,h,g,_=[],b=typeof e;if(o=o||t,"undefined"===b||"function"===b){for(n=!n.length&&e.length?["require","exports","module"]:n,h=0;h<n.length;h+=1)if(p=d(n[h],o),f=p.f,"require"===f)_[h]=v.require(t);else if("exports"===f)_[h]=v.exports(t),g=!0;else if("module"===f)s=_[h]=v.module(t);else if(i(y,f)||i(m,f)||i(w,f))_[h]=a(f);else{if(!p.p)throw new Error(t+" missing "+f);p.p.load(p.n,u(o,!0),c(f),{}),_[h]=y[f]}l=e?e.apply(y[t],_):void 0,t&&(s&&s.exports!==r&&s.exports!==y[t]?y[t]=s.exports:l===r&&g||(y[t]=l))}else t&&(y[t]=e)},t=n=h=function(t,n,e,i,o){if("string"==typeof t)return v[t]?v[t](n):a(d(t,n).f);if(!t.splice){if(g=t,g.deps&&h(g.deps,g.callback),!n)return;n.splice?(t=n,n=e,e=null):t=r}return n=n||function(){},"function"==typeof e&&(e=i,i=o),i?p(r,t,n,e):setTimeout(function(){p(r,t,n,e)},4),h},h.config=function(t){return h(t)},t._defined=y,e=function(t,n,e){n.splice||(e=n,n=[]),i(y,t)||i(m,t)||(m[t]=[t,n,e])},e.amd={jQuery:!0}}(),e("node_modules/almond/almond.js",function(){}),function(t){if("function"==typeof bootstrap)bootstrap("promise",t);else if("object"==typeof exports)module.exports=t();else if("function"==typeof e&&e.amd)e("q",t);else if("undefined"!=typeof ses){if(!ses.ok())return;ses.makeQ=t}else Q=t()}(function(){"use strict";function t(t){return function(){return W.apply(t,arguments)}}function n(t){return t===Object(t)}function e(t){return"[object StopIteration]"===nn(t)||t instanceof $}function r(t,n){if(C&&n.stack&&"object"==typeof t&&null!==t&&t.stack&&-1===t.stack.indexOf(en)){for(var e=[],r=n;r;r=r.source)r.stack&&e.unshift(r.stack);e.unshift(t.stack);var o=e.join("\n"+en+"\n");t.stack=i(o)}}function i(t){for(var n=t.split("\n"),e=[],r=0;r<n.length;++r){var i=n[r];s(i)||o(i)||!i||e.push(i)}return e.join("\n")}function o(t){return-1!==t.indexOf("(module.js:")||-1!==t.indexOf("(node.js:")}function u(t){var n=/at .+ \((.+):(\d+):(?:\d+)\)$/.exec(t);if(n)return[n[1],Number(n[2])];var e=/at ([^ ]+):(\d+):(?:\d+)$/.exec(t);if(e)return[e[1],Number(e[2])];var r=/.*@(.+):(\d+)$/.exec(t);return r?[r[1],Number(r[2])]:void 0}function s(t){var n=u(t);if(!n)return!1;var e=n[0],r=n[1];return e===z&&r>=Q&&sn>=r}function c(){if(C)try{throw new Error}catch(t){var n=t.stack.split("\n"),e=n[0].indexOf("@")>0?n[1]:n[2],r=u(e);if(!r)return;return z=r[0],r[1]}}function a(t,n,e){return function(){return"undefined"!=typeof console&&"function"==typeof console.warn&&console.warn(n+" is deprecated, use "+e+" instead.",new Error("").stack),t.apply(t,arguments)}}function f(t){return m(t)?t:g(t)?A(t):S(t)}function l(){function t(t){n=t,o.source=t,G(e,function(n,e){H(function(){t.promiseDispatch.apply(t,e)})},void 0),e=void 0,r=void 0}var n,e=[],r=[],i=Y(l.prototype),o=Y(d.prototype);if(o.promiseDispatch=function(t,i,o){var u=X(arguments);e?(e.push(u),"when"===i&&o[1]&&r.push(o[1])):H(function(){n.promiseDispatch.apply(n,u)})},o.valueOf=function(){if(e)return o;var t=y(n);return m(t)&&(n=t),t},o.inspect=function(){return n?n.inspect():{state:"pending"}},f.longStackSupport&&C)try{throw new Error}catch(u){o.stack=u.stack.substring(u.stack.indexOf("\n")+1)}return i.promise=o,i.resolve=function(e){n||t(f(e))},i.fulfill=function(e){n||t(S(e))},i.reject=function(e){n||t(E(e))},i.notify=function(t){n||G(r,function(n,e){H(function(){e(t)})},void 0)},i}function p(t){if("function"!=typeof t)throw new TypeError("resolver must be a function.");var n=l();try{t(n.resolve,n.reject,n.notify)}catch(e){n.reject(e)}return n.promise}function h(t){return p(function(n,e){for(var r=0,i=t.length;i>r;r++)f(t[r]).then(n,e)})}function d(t,n,e){void 0===n&&(n=function(t){return E(new Error("Promise does not support operation: "+t))}),void 0===e&&(e=function(){return{state:"unknown"}});var r=Y(d.prototype);if(r.promiseDispatch=function(e,i,o){var u;try{u=t[i]?t[i].apply(r,o):n.call(r,i,o)}catch(s){u=E(s)}e&&e(u)},r.inspect=e,e){var i=e();"rejected"===i.state&&(r.exception=i.reason),r.valueOf=function(){var t=e();return"pending"===t.state||"rejected"===t.state?r:t.value}}return r}function v(t,n,e,r){return f(t).then(n,e,r)}function y(t){if(m(t)){var n=t.inspect();if("fulfilled"===n.state)return n.value}return t}function m(t){return n(t)&&"function"==typeof t.promiseDispatch&&"function"==typeof t.inspect}function g(t){return n(t)&&"function"==typeof t.then}function w(t){return m(t)&&"pending"===t.inspect().state}function _(t){return!m(t)||"fulfilled"===t.inspect().state}function b(t){return m(t)&&"rejected"===t.inspect().state}function k(){rn.length=0,on.length=0,un||(un=!0)}function j(t,n){un&&(on.push(t),rn.push(n&&"undefined"!=typeof n.stack?n.stack:"(no stack) "+n))}function x(t){if(un){var n=J(on,t);-1!==n&&(on.splice(n,1),rn.splice(n,1))}}function E(t){var n=d({when:function(n){return n&&x(this),n?n(t):this}},function(){return this},function(){return{state:"rejected",reason:t}});return j(n,t),n}function S(t){return d({when:function(){return t},get:function(n){return t[n]},set:function(n,e){t[n]=e},"delete":function(n){delete t[n]},post:function(n,e){return null===n||void 0===n?t.apply(void 0,e):t[n].apply(t,e)},apply:function(n,e){return t.apply(n,e)},keys:function(){return tn(t)}},void 0,function(){return{state:"fulfilled",value:t}})}function A(t){var n=l();return H(function(){try{t.then(n.resolve,n.reject,n.notify)}catch(e){n.reject(e)}}),n.promise}function T(t){return d({isDef:function(){}},function(n,e){return M(t,n,e)},function(){return f(t).inspect()})}function O(t,n,e){return f(t).spread(n,e)}function L(t){return function(){function n(t,n){var u;if("undefined"==typeof StopIteration){try{u=r[t](n)}catch(s){return E(s)}return u.done?u.value:v(u.value,i,o)}try{u=r[t](n)}catch(s){return e(s)?s.value:E(s)}return v(u,i,o)}var r=t.apply(this,arguments),i=n.bind(n,"next"),o=n.bind(n,"throw");return i()}}function R(t){f.done(f.async(t)())}function N(t){throw new $(t)}function F(t){return function(){return O([this,I(arguments)],function(n,e){return t.apply(n,e)})}}function M(t,n,e){return f(t).dispatch(n,e)}function I(t){return v(t,function(t){var n=0,e=l();return G(t,function(r,i,o){var u;m(i)&&"fulfilled"===(u=i.inspect()).state?t[o]=u.value:(++n,v(i,function(r){t[o]=r,0===--n&&e.resolve(t)},e.reject,function(t){e.notify({index:o,value:t})}))},void 0),0===n&&e.resolve(t),e.promise})}function q(t){return v(t,function(t){return t=K(t,f),v(I(K(t,function(t){return v(t,V,V)})),function(){return t})})}function D(t){return f(t).allSettled()}function P(t,n){return f(t).then(void 0,void 0,n)}function B(t,n){return f(t).nodeify(n)}var C=!1;try{throw new Error}catch(U){C=!!U.stack}var z,$,Q=c(),V=function(){},H=function(){function t(){for(;n.next;){n=n.next;var e=n.task;n.task=void 0;var i=n.domain;i&&(n.domain=void 0,i.enter());try{e()}catch(u){if(o)throw i&&i.exit(),setTimeout(t,0),i&&i.enter(),u;setTimeout(function(){throw u},0)}i&&i.exit()}r=!1}var n={task:void 0,next:null},e=n,r=!1,i=void 0,o=!1;if(H=function(t){e=e.next={task:t,domain:o&&process.domain,next:null},r||(r=!0,i())},"undefined"!=typeof process&&process.nextTick)o=!0,i=function(){process.nextTick(t)};else if("function"==typeof setImmediate)i="undefined"!=typeof window?setImmediate.bind(window,t):function(){setImmediate(t)};else if("undefined"!=typeof MessageChannel){var u=new MessageChannel;u.port1.onmessage=function(){i=s,u.port1.onmessage=t,t()};var s=function(){u.port2.postMessage(0)};i=function(){setTimeout(t,0),s()}}else i=function(){setTimeout(t,0)};return H}(),W=Function.call,X=t(Array.prototype.slice),G=t(Array.prototype.reduce||function(t,n){var e=0,r=this.length;if(1===arguments.length)for(;;){if(e in this){n=this[e++];break}if(++e>=r)throw new TypeError}for(;r>e;e++)e in this&&(n=t(n,this[e],e));return n}),J=t(Array.prototype.indexOf||function(t){for(var n=0;n<this.length;n++)if(this[n]===t)return n;return-1}),K=t(Array.prototype.map||function(t,n){var e=this,r=[];return G(e,function(i,o,u){r.push(t.call(n,o,u,e))},void 0),r}),Y=Object.create||function(t){function n(){}return n.prototype=t,new n},Z=t(Object.prototype.hasOwnProperty),tn=Object.keys||function(t){var n=[];for(var e in t)Z(t,e)&&n.push(e);return n},nn=t(Object.prototype.toString);$="undefined"!=typeof ReturnValue?ReturnValue:function(t){this.value=t};var en="From previous event:";f.resolve=f,f.nextTick=H,f.longStackSupport=!1,f.defer=l,l.prototype.makeNodeResolver=function(){var t=this;return function(n,e){n?t.reject(n):t.resolve(arguments.length>2?X(arguments,1):e)}},f.Promise=p,f.promise=p,p.race=h,p.all=I,p.reject=E,p.resolve=f,f.passByCopy=function(t){return t},d.prototype.passByCopy=function(){return this},f.join=function(t,n){return f(t).join(n)},d.prototype.join=function(t){return f([this,t]).spread(function(t,n){if(t===n)return t;throw new Error("Can't join: not the same: "+t+" "+n)})},f.race=h,d.prototype.race=function(){return this.then(f.race)},f.makePromise=d,d.prototype.toString=function(){return"[object Promise]"},d.prototype.then=function(t,n,e){function i(n){try{return"function"==typeof t?t(n):n}catch(e){return E(e)}}function o(t){if("function"==typeof n){r(t,s);try{return n(t)}catch(e){return E(e)}}return E(t)}function u(t){return"function"==typeof e?e(t):t}var s=this,c=l(),a=!1;return H(function(){s.promiseDispatch(function(t){a||(a=!0,c.resolve(i(t)))},"when",[function(t){a||(a=!0,c.resolve(o(t)))}])}),s.promiseDispatch(void 0,"when",[void 0,function(t){var n,e=!1;try{n=u(t)}catch(r){if(e=!0,!f.onerror)throw r;f.onerror(r)}e||c.notify(n)}]),c.promise},f.when=v,d.prototype.thenResolve=function(t){return this.then(function(){return t})},f.thenResolve=function(t,n){return f(t).thenResolve(n)},d.prototype.thenReject=function(t){return this.then(function(){throw t})},f.thenReject=function(t,n){return f(t).thenReject(n)},f.nearer=y,f.isPromise=m,f.isPromiseAlike=g,f.isPending=w,d.prototype.isPending=function(){return"pending"===this.inspect().state},f.isFulfilled=_,d.prototype.isFulfilled=function(){return"fulfilled"===this.inspect().state},f.isRejected=b,d.prototype.isRejected=function(){return"rejected"===this.inspect().state};var rn=[],on=[],un=!0;f.resetUnhandledRejections=k,f.getUnhandledReasons=function(){return rn.slice()},f.stopUnhandledRejectionTracking=function(){k(),un=!1},k(),f.reject=E,f.fulfill=S,f.master=T,f.spread=O,d.prototype.spread=function(t,n){return this.all().then(function(n){return t.apply(void 0,n)},n)},f.async=L,f.spawn=R,f["return"]=N,f.promised=F,f.dispatch=M,d.prototype.dispatch=function(t,n){var e=this,r=l();return H(function(){e.promiseDispatch(r.resolve,t,n)}),r.promise},f.get=function(t,n){return f(t).dispatch("get",[n])},d.prototype.get=function(t){return this.dispatch("get",[t])},f.set=function(t,n,e){return f(t).dispatch("set",[n,e])},d.prototype.set=function(t,n){return this.dispatch("set",[t,n])},f.del=f["delete"]=function(t,n){return f(t).dispatch("delete",[n])},d.prototype.del=d.prototype["delete"]=function(t){return this.dispatch("delete",[t])},f.mapply=f.post=function(t,n,e){return f(t).dispatch("post",[n,e])},d.prototype.mapply=d.prototype.post=function(t,n){return this.dispatch("post",[t,n])},f.send=f.mcall=f.invoke=function(t,n){return f(t).dispatch("post",[n,X(arguments,2)])},d.prototype.send=d.prototype.mcall=d.prototype.invoke=function(t){return this.dispatch("post",[t,X(arguments,1)])},f.fapply=function(t,n){return f(t).dispatch("apply",[void 0,n])},d.prototype.fapply=function(t){return this.dispatch("apply",[void 0,t])},f["try"]=f.fcall=function(t){return f(t).dispatch("apply",[void 0,X(arguments,1)])},d.prototype.fcall=function(){return this.dispatch("apply",[void 0,X(arguments)])},f.fbind=function(t){var n=f(t),e=X(arguments,1);return function(){return n.dispatch("apply",[this,e.concat(X(arguments))])}},d.prototype.fbind=function(){var t=this,n=X(arguments);return function(){return t.dispatch("apply",[this,n.concat(X(arguments))])}},f.keys=function(t){return f(t).dispatch("keys",[])},d.prototype.keys=function(){return this.dispatch("keys",[])},f.all=I,d.prototype.all=function(){return I(this)},f.allResolved=a(q,"allResolved","allSettled"),d.prototype.allResolved=function(){return q(this)},f.allSettled=D,d.prototype.allSettled=function(){return this.then(function(t){return I(K(t,function(t){function n(){return t.inspect()}return t=f(t),t.then(n,n)}))})},f.fail=f["catch"]=function(t,n){return f(t).then(void 0,n)},d.prototype.fail=d.prototype["catch"]=function(t){return this.then(void 0,t)},f.progress=P,d.prototype.progress=function(t){return this.then(void 0,void 0,t)},f.fin=f["finally"]=function(t,n){return f(t)["finally"](n)},d.prototype.fin=d.prototype["finally"]=function(t){return t=f(t),this.then(function(n){return t.fcall().then(function(){return n})},function(n){return t.fcall().then(function(){throw n})})},f.done=function(t,n,e,r){return f(t).done(n,e,r)},d.prototype.done=function(t,n,e){var i=function(t){H(function(){if(r(t,o),!f.onerror)throw t;f.onerror(t)})},o=t||n||e?this.then(t,n,e):this;"object"==typeof process&&process&&process.domain&&(i=process.domain.bind(i)),o.then(void 0,i)},f.timeout=function(t,n,e){return f(t).timeout(n,e)},d.prototype.timeout=function(t,n){var e=l(),r=setTimeout(function(){e.reject(new Error(n||"Timed out after "+t+" ms"))},t);return this.then(function(t){clearTimeout(r),e.resolve(t)},function(t){clearTimeout(r),e.reject(t)},e.notify),e.promise},f.delay=function(t,n){return void 0===n&&(n=t,t=void 0),f(t).delay(n)},d.prototype.delay=function(t){return this.then(function(n){var e=l();return setTimeout(function(){e.resolve(n)},t),e.promise})},f.nfapply=function(t,n){return f(t).nfapply(n)},d.prototype.nfapply=function(t){var n=l(),e=X(t);return e.push(n.makeNodeResolver()),this.fapply(e).fail(n.reject),n.promise},f.nfcall=function(t){var n=X(arguments,1);return f(t).nfapply(n)},d.prototype.nfcall=function(){var t=X(arguments),n=l();return t.push(n.makeNodeResolver()),this.fapply(t).fail(n.reject),n.promise},f.nfbind=f.denodeify=function(t){var n=X(arguments,1);return function(){var e=n.concat(X(arguments)),r=l();return e.push(r.makeNodeResolver()),f(t).fapply(e).fail(r.reject),r.promise}},d.prototype.nfbind=d.prototype.denodeify=function(){var t=X(arguments);return t.unshift(this),f.denodeify.apply(void 0,t)},f.nbind=function(t,n){var e=X(arguments,2);return function(){function r(){return t.apply(n,arguments)}var i=e.concat(X(arguments)),o=l();return i.push(o.makeNodeResolver()),f(r).fapply(i).fail(o.reject),o.promise}},d.prototype.nbind=function(){var t=X(arguments,0);return t.unshift(this),f.nbind.apply(void 0,t)},f.nmapply=f.npost=function(t,n,e){return f(t).npost(n,e)},d.prototype.nmapply=d.prototype.npost=function(t,n){var e=X(n||[]),r=l();return e.push(r.makeNodeResolver()),this.dispatch("post",[t,e]).fail(r.reject),r.promise},f.nsend=f.nmcall=f.ninvoke=function(t,n){var e=X(arguments,2),r=l();return e.push(r.makeNodeResolver()),f(t).dispatch("post",[n,e]).fail(r.reject),r.promise},d.prototype.nsend=d.prototype.nmcall=d.prototype.ninvoke=function(t){var n=X(arguments,1),e=l();return n.push(e.makeNodeResolver()),this.dispatch("post",[t,n]).fail(e.reject),e.promise},f.nodeify=B,d.prototype.nodeify=function(t){return t?void this.then(function(n){H(function(){t(null,n)})},function(n){H(function(){t(n)})}):this};var sn=c();return f}),e("lib/util/lazyLoader",["q"],function(t){return function(n){var e=t.defer(),r=new XMLHttpRequest,i=function(t){var n=t.currentTarget;if(4===n.readyState){if(200!==n.status)return e.reject(new Error(n.statusText));try{window.eval(n.responseText)}catch(r){e.reject(r)}e.resolve(window.io)}};return r.onreadystatechange=i,r.open("get",n,!0),r.send(),e.promise}}),function(){var t=this,n=t._,r={},i=Array.prototype,o=Object.prototype,u=Function.prototype,s=i.push,c=i.slice,a=i.concat,f=o.toString,l=o.hasOwnProperty,p=i.forEach,h=i.map,d=i.reduce,v=i.reduceRight,y=i.filter,m=i.every,g=i.some,w=i.indexOf,_=i.lastIndexOf,b=Array.isArray,k=Object.keys,j=u.bind,x=function(t){return t instanceof x?t:this instanceof x?void(this._wrapped=t):new x(t)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=x),exports._=x):t._=x,x.VERSION="1.6.0";var E=x.each=x.forEach=function(t,n,e){if(null==t)return t;if(p&&t.forEach===p)t.forEach(n,e);else if(t.length===+t.length){for(var i=0,o=t.length;o>i;i++)if(n.call(e,t[i],i,t)===r)return}else for(var u=x.keys(t),i=0,o=u.length;o>i;i++)if(n.call(e,t[u[i]],u[i],t)===r)return;return t};x.map=x.collect=function(t,n,e){var r=[];return null==t?r:h&&t.map===h?t.map(n,e):(E(t,function(t,i,o){r.push(n.call(e,t,i,o))}),r)};var S="Reduce of empty array with no initial value";x.reduce=x.foldl=x.inject=function(t,n,e,r){var i=arguments.length>2;if(null==t&&(t=[]),d&&t.reduce===d)return r&&(n=x.bind(n,r)),i?t.reduce(n,e):t.reduce(n);if(E(t,function(t,o,u){i?e=n.call(r,e,t,o,u):(e=t,i=!0)}),!i)throw new TypeError(S);return e},x.reduceRight=x.foldr=function(t,n,e,r){var i=arguments.length>2;if(null==t&&(t=[]),v&&t.reduceRight===v)return r&&(n=x.bind(n,r)),i?t.reduceRight(n,e):t.reduceRight(n);var o=t.length;if(o!==+o){var u=x.keys(t);o=u.length}if(E(t,function(s,c,a){c=u?u[--o]:--o,i?e=n.call(r,e,t[c],c,a):(e=t[c],i=!0)}),!i)throw new TypeError(S);return e},x.find=x.detect=function(t,n,e){var r;return A(t,function(t,i,o){return n.call(e,t,i,o)?(r=t,!0):void 0}),r},x.filter=x.select=function(t,n,e){var r=[];return null==t?r:y&&t.filter===y?t.filter(n,e):(E(t,function(t,i,o){n.call(e,t,i,o)&&r.push(t)}),r)},x.reject=function(t,n,e){return x.filter(t,function(t,r,i){return!n.call(e,t,r,i)},e)},x.every=x.all=function(t,n,e){n||(n=x.identity);var i=!0;return null==t?i:m&&t.every===m?t.every(n,e):(E(t,function(t,o,u){return(i=i&&n.call(e,t,o,u))?void 0:r}),!!i)};var A=x.some=x.any=function(t,n,e){n||(n=x.identity);var i=!1;return null==t?i:g&&t.some===g?t.some(n,e):(E(t,function(t,o,u){return i||(i=n.call(e,t,o,u))?r:void 0}),!!i)};x.contains=x.include=function(t,n){return null==t?!1:w&&t.indexOf===w?-1!=t.indexOf(n):A(t,function(t){return t===n})},x.invoke=function(t,n){var e=c.call(arguments,2),r=x.isFunction(n);return x.map(t,function(t){return(r?n:t[n]).apply(t,e)})},x.pluck=function(t,n){return x.map(t,x.property(n))},x.where=function(t,n){return x.filter(t,x.matches(n))},x.findWhere=function(t,n){return x.find(t,x.matches(n))},x.max=function(t,n,e){if(!n&&x.isArray(t)&&t[0]===+t[0]&&t.length<65535)return Math.max.apply(Math,t);var r=-1/0,i=-1/0;return E(t,function(t,o,u){var s=n?n.call(e,t,o,u):t;s>i&&(r=t,i=s)}),r},x.min=function(t,n,e){if(!n&&x.isArray(t)&&t[0]===+t[0]&&t.length<65535)return Math.min.apply(Math,t);var r=1/0,i=1/0;return E(t,function(t,o,u){var s=n?n.call(e,t,o,u):t;i>s&&(r=t,i=s)}),r},x.shuffle=function(t){var n,e=0,r=[];return E(t,function(t){n=x.random(e++),r[e-1]=r[n],r[n]=t}),r},x.sample=function(t,n,e){return null==n||e?(t.length!==+t.length&&(t=x.values(t)),t[x.random(t.length-1)]):x.shuffle(t).slice(0,Math.max(0,n))};var T=function(t){return null==t?x.identity:x.isFunction(t)?t:x.property(t)};x.sortBy=function(t,n,e){return n=T(n),x.pluck(x.map(t,function(t,r,i){return{value:t,index:r,criteria:n.call(e,t,r,i)}}).sort(function(t,n){var e=t.criteria,r=n.criteria;if(e!==r){if(e>r||void 0===e)return 1;if(r>e||void 0===r)return-1}return t.index-n.index}),"value")};var O=function(t){return function(n,e,r){var i={};return e=T(e),E(n,function(o,u){var s=e.call(r,o,u,n);t(i,s,o)}),i}};x.groupBy=O(function(t,n,e){x.has(t,n)?t[n].push(e):t[n]=[e]}),x.indexBy=O(function(t,n,e){t[n]=e}),x.countBy=O(function(t,n){x.has(t,n)?t[n]++:t[n]=1}),x.sortedIndex=function(t,n,e,r){e=T(e);for(var i=e.call(r,n),o=0,u=t.length;u>o;){var s=o+u>>>1;e.call(r,t[s])<i?o=s+1:u=s}return o},x.toArray=function(t){return t?x.isArray(t)?c.call(t):t.length===+t.length?x.map(t,x.identity):x.values(t):[]},x.size=function(t){return null==t?0:t.length===+t.length?t.length:x.keys(t).length},x.first=x.head=x.take=function(t,n,e){return null==t?void 0:null==n||e?t[0]:0>n?[]:c.call(t,0,n)},x.initial=function(t,n,e){return c.call(t,0,t.length-(null==n||e?1:n))},x.last=function(t,n,e){return null==t?void 0:null==n||e?t[t.length-1]:c.call(t,Math.max(t.length-n,0))},x.rest=x.tail=x.drop=function(t,n,e){return c.call(t,null==n||e?1:n)},x.compact=function(t){return x.filter(t,x.identity)};var L=function(t,n,e){return n&&x.every(t,x.isArray)?a.apply(e,t):(E(t,function(t){x.isArray(t)||x.isArguments(t)?n?s.apply(e,t):L(t,n,e):e.push(t)}),e)};x.flatten=function(t,n){return L(t,n,[])},x.without=function(t){return x.difference(t,c.call(arguments,1))},x.partition=function(t,n){var e=[],r=[];return E(t,function(t){(n(t)?e:r).push(t)}),[e,r]},x.uniq=x.unique=function(t,n,e,r){x.isFunction(n)&&(r=e,e=n,n=!1);var i=e?x.map(t,e,r):t,o=[],u=[];return E(i,function(e,r){(n?r&&u[u.length-1]===e:x.contains(u,e))||(u.push(e),o.push(t[r]))}),o},x.union=function(){return x.uniq(x.flatten(arguments,!0))},x.intersection=function(t){var n=c.call(arguments,1);return x.filter(x.uniq(t),function(t){return x.every(n,function(n){return x.contains(n,t)})})},x.difference=function(t){var n=a.apply(i,c.call(arguments,1));return x.filter(t,function(t){return!x.contains(n,t)})},x.zip=function(){for(var t=x.max(x.pluck(arguments,"length").concat(0)),n=new Array(t),e=0;t>e;e++)n[e]=x.pluck(arguments,""+e);return n},x.object=function(t,n){if(null==t)return{};for(var e={},r=0,i=t.length;i>r;r++)n?e[t[r]]=n[r]:e[t[r][0]]=t[r][1];return e},x.indexOf=function(t,n,e){if(null==t)return-1;var r=0,i=t.length;if(e){if("number"!=typeof e)return r=x.sortedIndex(t,n),t[r]===n?r:-1;r=0>e?Math.max(0,i+e):e}if(w&&t.indexOf===w)return t.indexOf(n,e);for(;i>r;r++)if(t[r]===n)return r;return-1},x.lastIndexOf=function(t,n,e){if(null==t)return-1;var r=null!=e;if(_&&t.lastIndexOf===_)return r?t.lastIndexOf(n,e):t.lastIndexOf(n);for(var i=r?e:t.length;i--;)if(t[i]===n)return i;return-1},x.range=function(t,n,e){arguments.length<=1&&(n=t||0,t=0),e=arguments[2]||1;for(var r=Math.max(Math.ceil((n-t)/e),0),i=0,o=new Array(r);r>i;)o[i++]=t,t+=e;return o};var R=function(){};x.bind=function(t,n){var e,r;if(j&&t.bind===j)return j.apply(t,c.call(arguments,1));if(!x.isFunction(t))throw new TypeError;return e=c.call(arguments,2),r=function(){if(!(this instanceof r))return t.apply(n,e.concat(c.call(arguments)));R.prototype=t.prototype;var i=new R;R.prototype=null;var o=t.apply(i,e.concat(c.call(arguments)));return Object(o)===o?o:i}},x.partial=function(t){var n=c.call(arguments,1);return function(){for(var e=0,r=n.slice(),i=0,o=r.length;o>i;i++)r[i]===x&&(r[i]=arguments[e++]);for(;e<arguments.length;)r.push(arguments[e++]);return t.apply(this,r)}},x.bindAll=function(t){var n=c.call(arguments,1);if(0===n.length)throw new Error("bindAll must be passed function names");return E(n,function(n){t[n]=x.bind(t[n],t)}),t},x.memoize=function(t,n){var e={};return n||(n=x.identity),function(){var r=n.apply(this,arguments);return x.has(e,r)?e[r]:e[r]=t.apply(this,arguments)}},x.delay=function(t,n){var e=c.call(arguments,2);return setTimeout(function(){return t.apply(null,e)},n)},x.defer=function(t){return x.delay.apply(x,[t,1].concat(c.call(arguments,1)))},x.throttle=function(t,n,e){var r,i,o,u=null,s=0;e||(e={});var c=function(){s=e.leading===!1?0:x.now(),u=null,o=t.apply(r,i),r=i=null};return function(){var a=x.now();s||e.leading!==!1||(s=a);var f=n-(a-s);return r=this,i=arguments,0>=f?(clearTimeout(u),u=null,s=a,o=t.apply(r,i),r=i=null):u||e.trailing===!1||(u=setTimeout(c,f)),o}},x.debounce=function(t,n,e){var r,i,o,u,s,c=function(){var a=x.now()-u;n>a?r=setTimeout(c,n-a):(r=null,e||(s=t.apply(o,i),o=i=null))};return function(){o=this,i=arguments,u=x.now();var a=e&&!r;return r||(r=setTimeout(c,n)),a&&(s=t.apply(o,i),o=i=null),s}},x.once=function(t){var n,e=!1;return function(){return e?n:(e=!0,n=t.apply(this,arguments),t=null,n)}},x.wrap=function(t,n){return x.partial(n,t)},x.compose=function(){var t=arguments;return function(){for(var n=arguments,e=t.length-1;e>=0;e--)n=[t[e].apply(this,n)];return n[0]}},x.after=function(t,n){return function(){return--t<1?n.apply(this,arguments):void 0}},x.keys=function(t){if(!x.isObject(t))return[];if(k)return k(t);var n=[];for(var e in t)x.has(t,e)&&n.push(e);return n},x.values=function(t){for(var n=x.keys(t),e=n.length,r=new Array(e),i=0;e>i;i++)r[i]=t[n[i]];return r},x.pairs=function(t){for(var n=x.keys(t),e=n.length,r=new Array(e),i=0;e>i;i++)r[i]=[n[i],t[n[i]]];return r},x.invert=function(t){for(var n={},e=x.keys(t),r=0,i=e.length;i>r;r++)n[t[e[r]]]=e[r];return n},x.functions=x.methods=function(t){var n=[];for(var e in t)x.isFunction(t[e])&&n.push(e);return n.sort()},x.extend=function(t){return E(c.call(arguments,1),function(n){if(n)for(var e in n)t[e]=n[e]}),t},x.pick=function(t){var n={},e=a.apply(i,c.call(arguments,1));return E(e,function(e){e in t&&(n[e]=t[e])}),n},x.omit=function(t){var n={},e=a.apply(i,c.call(arguments,1));for(var r in t)x.contains(e,r)||(n[r]=t[r]);return n},x.defaults=function(t){return E(c.call(arguments,1),function(n){if(n)for(var e in n)void 0===t[e]&&(t[e]=n[e])}),t},x.clone=function(t){return x.isObject(t)?x.isArray(t)?t.slice():x.extend({},t):t},x.tap=function(t,n){return n(t),t};var N=function(t,n,e,r){if(t===n)return 0!==t||1/t==1/n;if(null==t||null==n)return t===n;t instanceof x&&(t=t._wrapped),n instanceof x&&(n=n._wrapped);var i=f.call(t);if(i!=f.call(n))return!1;switch(i){case"[object String]":return t==String(n);case"[object Number]":return t!=+t?n!=+n:0==t?1/t==1/n:t==+n;case"[object Date]":case"[object Boolean]":return+t==+n;case"[object RegExp]":return t.source==n.source&&t.global==n.global&&t.multiline==n.multiline&&t.ignoreCase==n.ignoreCase}if("object"!=typeof t||"object"!=typeof n)return!1;for(var o=e.length;o--;)if(e[o]==t)return r[o]==n;var u=t.constructor,s=n.constructor;if(u!==s&&!(x.isFunction(u)&&u instanceof u&&x.isFunction(s)&&s instanceof s)&&"constructor"in t&&"constructor"in n)return!1;e.push(t),r.push(n);var c=0,a=!0;if("[object Array]"==i){if(c=t.length,a=c==n.length)for(;c--&&(a=N(t[c],n[c],e,r)););}else{for(var l in t)if(x.has(t,l)&&(c++,!(a=x.has(n,l)&&N(t[l],n[l],e,r))))break;if(a){for(l in n)if(x.has(n,l)&&!c--)break;a=!c}}return e.pop(),r.pop(),a};x.isEqual=function(t,n){return N(t,n,[],[])},x.isEmpty=function(t){if(null==t)return!0;if(x.isArray(t)||x.isString(t))return 0===t.length;for(var n in t)if(x.has(t,n))return!1;return!0},x.isElement=function(t){return!(!t||1!==t.nodeType)},x.isArray=b||function(t){return"[object Array]"==f.call(t)},x.isObject=function(t){return t===Object(t)},E(["Arguments","Function","String","Number","Date","RegExp"],function(t){x["is"+t]=function(n){return f.call(n)=="[object "+t+"]"}}),x.isArguments(arguments)||(x.isArguments=function(t){return!(!t||!x.has(t,"callee"))}),"function"!=typeof/./&&(x.isFunction=function(t){return"function"==typeof t}),x.isFinite=function(t){return isFinite(t)&&!isNaN(parseFloat(t))},x.isNaN=function(t){return x.isNumber(t)&&t!=+t},x.isBoolean=function(t){return t===!0||t===!1||"[object Boolean]"==f.call(t)},x.isNull=function(t){return null===t},x.isUndefined=function(t){return void 0===t},x.has=function(t,n){return l.call(t,n)},x.noConflict=function(){return t._=n,this},x.identity=function(t){return t},x.constant=function(t){return function(){return t}},x.property=function(t){return function(n){return n[t]}},x.matches=function(t){return function(n){if(n===t)return!0;for(var e in t)if(t[e]!==n[e])return!1;return!0}},x.times=function(t,n,e){for(var r=Array(Math.max(0,t)),i=0;t>i;i++)r[i]=n.call(e,i);return r},x.random=function(t,n){return null==n&&(n=t,t=0),t+Math.floor(Math.random()*(n-t+1))},x.now=Date.now||function(){return(new Date).getTime()};var F={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"}};F.unescape=x.invert(F.escape);var M={escape:new RegExp("["+x.keys(F.escape).join("")+"]","g"),unescape:new RegExp("("+x.keys(F.unescape).join("|")+")","g")};x.each(["escape","unescape"],function(t){x[t]=function(n){return null==n?"":(""+n).replace(M[t],function(n){return F[t][n]})}}),x.result=function(t,n){if(null==t)return void 0;var e=t[n];return x.isFunction(e)?e.call(t):e},x.mixin=function(t){E(x.functions(t),function(n){var e=x[n]=t[n];x.prototype[n]=function(){var t=[this._wrapped];return s.apply(t,arguments),B.call(this,e.apply(x,t))}})};var I=0;x.uniqueId=function(t){var n=++I+"";return t?t+n:n},x.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var q=/(.)^/,D={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},P=/\\|'|\r|\n|\t|\u2028|\u2029/g;x.template=function(t,n,e){var r;e=x.defaults({},e,x.templateSettings);var i=new RegExp([(e.escape||q).source,(e.interpolate||q).source,(e.evaluate||q).source].join("|")+"|$","g"),o=0,u="__p+='";t.replace(i,function(n,e,r,i,s){return u+=t.slice(o,s).replace(P,function(t){return"\\"+D[t]}),e&&(u+="'+\n((__t=("+e+"))==null?'':_.escape(__t))+\n'"),r&&(u+="'+\n((__t=("+r+"))==null?'':__t)+\n'"),i&&(u+="';\n"+i+"\n__p+='"),o=s+n.length,n}),u+="';\n",e.variable||(u="with(obj||{}){\n"+u+"}\n"),u="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+u+"return __p;\n";try{r=new Function(e.variable||"obj","_",u)}catch(s){throw s.source=u,s}if(n)return r(n,x);var c=function(t){return r.call(this,t,x)};return c.source="function("+(e.variable||"obj")+"){\n"+u+"}",c},x.chain=function(t){return x(t).chain()};var B=function(t){return this._chain?x(t).chain():t};x.mixin(x),E(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var n=i[t];x.prototype[t]=function(){var e=this._wrapped;return n.apply(e,arguments),"shift"!=t&&"splice"!=t||0!==e.length||delete e[0],B.call(this,e)}}),E(["concat","join","slice"],function(t){var n=i[t];x.prototype[t]=function(){return B.call(this,n.apply(this._wrapped,arguments))}}),x.extend(x.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}}),"function"==typeof e&&e.amd&&e("underscore",[],function(){return x})}.call(this),!function(t){function n(){this._events={},this._conf&&r.call(this,this._conf)}function r(t){t&&(this._conf=t,t.delimiter&&(this.delimiter=t.delimiter),t.maxListeners&&(this._events.maxListeners=t.maxListeners),t.wildcard&&(this.wildcard=t.wildcard),t.newListener&&(this.newListener=t.newListener),this.wildcard&&(this.listenerTree={}))
}function i(t){this._events={},this.newListener=!1,r.call(this,t)}function o(t,n,e,r){if(!e)return[];var i,u,s,c,a,f,l,p=[],h=n.length,d=n[r],v=n[r+1];if(r===h&&e._listeners){if("function"==typeof e._listeners)return t&&t.push(e._listeners),[e];for(i=0,u=e._listeners.length;u>i;i++)t&&t.push(e._listeners[i]);return[e]}if("*"===d||"**"===d||e[d]){if("*"===d){for(s in e)"_listeners"!==s&&e.hasOwnProperty(s)&&(p=p.concat(o(t,n,e[s],r+1)));return p}if("**"===d){l=r+1===h||r+2===h&&"*"===v,l&&e._listeners&&(p=p.concat(o(t,n,e,h)));for(s in e)"_listeners"!==s&&e.hasOwnProperty(s)&&("*"===s||"**"===s?(e[s]._listeners&&!l&&(p=p.concat(o(t,n,e[s],h))),p=p.concat(o(t,n,e[s],r))):p=p.concat(s===v?o(t,n,e[s],r+2):o(t,n,e[s],r)));return p}p=p.concat(o(t,n,e[d],r+1))}if(c=e["*"],c&&o(t,n,c,r+1),a=e["**"])if(h>r){a._listeners&&o(t,n,a,h);for(s in a)"_listeners"!==s&&a.hasOwnProperty(s)&&(s===v?o(t,n,a[s],r+2):s===d?o(t,n,a[s],r+1):(f={},f[s]=a[s],o(t,n,{"**":f},r+1)))}else a._listeners?o(t,n,a,h):a["*"]&&a["*"]._listeners&&o(t,n,a["*"],h);return p}function u(t,n){t="string"==typeof t?t.split(this.delimiter):t.slice();for(var e=0,r=t.length;r>e+1;e++)if("**"===t[e]&&"**"===t[e+1])return;for(var i=this.listenerTree,o=t.shift();o;){if(i[o]||(i[o]={}),i=i[o],0===t.length){if(i._listeners){if("function"==typeof i._listeners)i._listeners=[i._listeners,n];else if(s(i._listeners)&&(i._listeners.push(n),!i._listeners.warned)){var u=c;"undefined"!=typeof this._events.maxListeners&&(u=this._events.maxListeners),u>0&&i._listeners.length>u&&(i._listeners.warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",i._listeners.length),console.trace())}}else i._listeners=n;return!0}o=t.shift()}return!0}var s=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)},c=10;i.prototype.delimiter=".",i.prototype.setMaxListeners=function(t){this._events||n.call(this),this._events.maxListeners=t,this._conf||(this._conf={}),this._conf.maxListeners=t},i.prototype.event="",i.prototype.once=function(t,n){return this.many(t,1,n),this},i.prototype.many=function(t,n,e){function r(){0===--n&&i.off(t,r),e.apply(this,arguments)}var i=this;if("function"!=typeof e)throw new Error("many only accepts instances of Function");return r._origin=e,this.on(t,r),i},i.prototype.emit=function(){this._events||n.call(this);var t=arguments[0];if("newListener"===t&&!this.newListener&&!this._events.newListener)return!1;if(this._all){for(var e=arguments.length,r=new Array(e-1),i=1;e>i;i++)r[i-1]=arguments[i];for(i=0,e=this._all.length;e>i;i++)this.event=t,this._all[i].apply(this,r)}if("error"===t&&!(this._all||this._events.error||this.wildcard&&this.listenerTree.error))throw arguments[1]instanceof Error?arguments[1]:new Error("Uncaught, unspecified 'error' event.");var u;if(this.wildcard){u=[];var s="string"==typeof t?t.split(this.delimiter):t.slice();o.call(this,u,s,this.listenerTree,0)}else u=this._events[t];if("function"==typeof u){if(this.event=t,1===arguments.length)u.call(this);else if(arguments.length>1)switch(arguments.length){case 2:u.call(this,arguments[1]);break;case 3:u.call(this,arguments[1],arguments[2]);break;default:for(var e=arguments.length,r=new Array(e-1),i=1;e>i;i++)r[i-1]=arguments[i];u.apply(this,r)}return!0}if(u){for(var e=arguments.length,r=new Array(e-1),i=1;e>i;i++)r[i-1]=arguments[i];for(var c=u.slice(),i=0,e=c.length;e>i;i++)this.event=t,c[i].apply(this,r);return c.length>0||this._all}return this._all},i.prototype.on=function(t,e){if("function"==typeof t)return this.onAny(t),this;if("function"!=typeof e)throw new Error("on only accepts instances of Function");if(this._events||n.call(this),this.emit("newListener",t,e),this.wildcard)return u.call(this,t,e),this;if(this._events[t]){if("function"==typeof this._events[t])this._events[t]=[this._events[t],e];else if(s(this._events[t])&&(this._events[t].push(e),!this._events[t].warned)){var r=c;"undefined"!=typeof this._events.maxListeners&&(r=this._events.maxListeners),r>0&&this._events[t].length>r&&(this._events[t].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[t].length),console.trace())}}else this._events[t]=e;return this},i.prototype.onAny=function(t){if(this._all||(this._all=[]),"function"!=typeof t)throw new Error("onAny only accepts instances of Function");return this._all.push(t),this},i.prototype.addListener=i.prototype.on,i.prototype.off=function(t,n){if("function"!=typeof n)throw new Error("removeListener only takes instances of Function");var e,r=[];if(this.wildcard){var i="string"==typeof t?t.split(this.delimiter):t.slice();r=o.call(this,null,i,this.listenerTree,0)}else{if(!this._events[t])return this;e=this._events[t],r.push({_listeners:e})}for(var u=0;u<r.length;u++){var c=r[u];if(e=c._listeners,s(e)){for(var a=-1,f=0,l=e.length;l>f;f++)if(e[f]===n||e[f].listener&&e[f].listener===n||e[f]._origin&&e[f]._origin===n){a=f;break}if(0>a)continue;return this.wildcard?c._listeners.splice(a,1):this._events[t].splice(a,1),0===e.length&&(this.wildcard?delete c._listeners:delete this._events[t]),this}(e===n||e.listener&&e.listener===n||e._origin&&e._origin===n)&&(this.wildcard?delete c._listeners:delete this._events[t])}return this},i.prototype.offAny=function(t){var n,e=0,r=0;if(t&&this._all&&this._all.length>0){for(n=this._all,e=0,r=n.length;r>e;e++)if(t===n[e])return n.splice(e,1),this}else this._all=[];return this},i.prototype.removeListener=i.prototype.off,i.prototype.removeAllListeners=function(t){if(0===arguments.length)return!this._events||n.call(this),this;if(this.wildcard)for(var e="string"==typeof t?t.split(this.delimiter):t.slice(),r=o.call(this,null,e,this.listenerTree,0),i=0;i<r.length;i++){var u=r[i];u._listeners=null}else{if(!this._events[t])return this;this._events[t]=null}return this},i.prototype.listeners=function(t){if(this.wildcard){var e=[],r="string"==typeof t?t.split(this.delimiter):t.slice();return o.call(this,e,r,this.listenerTree,0),e}return this._events||n.call(this),this._events[t]||(this._events[t]=[]),s(this._events[t])||(this._events[t]=[this._events[t]]),this._events[t]},i.prototype.listenersAny=function(){return this._all?this._all:[]},"function"==typeof e&&e.amd?e("eventemitter2",[],function(){return i}):t.EventEmitter2=i}("undefined"!=typeof process&&"undefined"!=typeof process.title&&"undefined"!=typeof exports?exports:window),e("lib/networkService",["underscore","eventemitter2"],function(t,n){"use strict";var e=function(t){if(n.call(this),!t)throw new TypeError("Missing options argument.");if(!t.socket)throw new TypeError("Missing options.socket argument.");if(!t.service)throw new TypeError("Missing options.service argument.");this._options=t,this.config=this._options.service.config,this.id=this._options.service.id,this.name=this._options.service.name,this.type=this._options.service.type,this.url=this._options.service.url,this._options.socket.on("pinguela:servicesFound",this._onServicesFound.bind(this)),this._options.socket.on("pinguela:servicesLost",this._onServicesLost.bind(this))};return e.prototype=new n,e.prototype.constructor=e,e.prototype._onServicesFound=function(n){var e=this,r=t.find(n,function(t){return t.id===e.id});r&&(e.online=!0,e.emit("available",e))},e.prototype._onServicesLost=function(n){var e=this,r=t.find(n,function(t){return t.id===e.id});r&&(e.online=!1,e.emit("unavailable",e))},e.prototype._options=null,e.prototype.addEventListener=e.prototype.addListener,e.prototype.id=null,e.prototype.name=null,e.prototype.online=!0,e.prototype.onavailable=function(t){return this.addEventListener("available",t)},e.prototype.onnotify=function(t){return this.addEventListener("notify",t)},e.prototype.onunavailable=function(t){return this.addEventListener("unavailable",t)},e.prototype.type=null,e.prototype.url=null,e.prototype.config=null,e}),e("lib/networkServices",["underscore","eventemitter2","./networkService"],function(t,n,e){"use strict";var r=function(e){if(n.call(this),!e)throw new TypeError("Missing options argument.");if(!e.socket)throw new TypeError("Missing options.socket argument.");if(!e.services)throw new TypeError("Missing options.services argument.");if("function"!=typeof e.services.forEach)throw new TypeError("Expected options.services argument to be an array  .");this._socket=e.socket,t.each(e.services,this._addService,this),this._socket.on("pinguela:servicesFound",this._onServicesFound.bind(this)),this._socket.on("disconnect",this._onSocketDisconnect.bind(this)),this._socket.on("error",this._onSocketError.bind(this))};return r.prototype=new n,r.prototype.constructor=r,r.prototype._addService=function(t){var n=new e({service:t,socket:this._socket});n.onavailable(this._onServiceAvailable.bind(this)),n.onunavailable(this._onServiceUnavailable.bind(this)),this[this.length++]=n,this.servicesAvailable++,this.emit("servicefound",n)},r.prototype._getIds=function(){for(var t=[],n=0;n<this.length;n++)t.push(this[n].id);return t},r.prototype._onServiceAvailable=function(t){++this.servicesAvailable,this.emit("servicefound",t)},r.prototype._onServiceUnavailable=function(t){--this.servicesAvailable,this.emit("servicelost",t)},r.prototype._onServicesFound=function(n){var e=this._getIds(),r=function(n){return!t.contains(e,n.id)},i=t.filter(n,r,this);t.each(i,this._addService,this)},r.prototype._onSocketDisconnect=function(){},r.prototype._onSocketError=function(){},r.prototype._socket=null,r.prototype.addEventListener=r.prototype.addListener,r.prototype.getServiceById=function(){throw new Error("Not implemented.")},r.prototype.length=0,r.prototype.onservicefound=function(t){return this.addEventListener("servicefound",t)},r.prototype.onservicelost=function(t){return this.addEventListener("servicelost",t)},r.prototype.servicesAvailable=0,r}),e("lib/navigatorNetworkService",["./util/lazyLoader","./networkService","./networkServices","q","require"],function(t,n,e,r){"use strict";var i={};return i.getNetworkServices=function(n,i,o){var u=r.defer(),s=function(t){u.reject(t)},c=function(t){a(t)},a=function(t){var r=t.connect(window.location.protocol+window.location.host),s=function(){r.emit("pinguela:getNetworkServices",n)},c=function(t){"function"==typeof o?o(t):u.reject(t)},a=function(t){var n={services:t,socket:r},o=new e(n);"function"==typeof i?i(o):u.resolve(o)};r.on("connect",s),r.on("pinguela:networkServices",a),r.on("error",c),r.socket&&r.socket.connected&&r.emit("pinguela:getNetworkServices",n)};return window.io?a(window.io):t("/socket.io/socket.io.js").then(c,s),u.promise},i}),e("lib/navigator.js",["./navigatorNetworkService"],function(t){"use strict";return navigator&&"function"!=typeof navigator.getNetworkServices&&(navigator.getNetworkServices=t.getNetworkServices),navigator}),n("./lib/navigator.js")}();